<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <meta charset="UTF-8" />
    <title th:text="${task.id} != null ? 'Edytuj zadanie' : 'Dodaj zadanie'">Zadanie</title>
    <link rel="stylesheet" th:href="@{/css/tasks.css}" />
</head>
<body>
<header class="page-header">
    <h1 th:text="${task.id} != null ? 'Edytuj zadanie' : 'Dodaj zadanie'">Zadanie</h1>
</header>

<section class="form-container">
    <form th:action="@{/tasks/save}" method="post" th:object="${task}" novalidate class="edit-form">
        <input type="hidden" th:field="*{id}" />

        <div class="form-row">
            <label>Nazwa <span class="req">*</span>
                <input type="text" th:field="*{name}" maxlength="150" required />
            </label>
            <div class="field-hint" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Błąd</div>
        </div>

        <div class="form-row">
            <label>Opis
                <input type="text" th:field="*{description}" maxlength="255" />
            </label>
            <div class="field-hint" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">Błąd</div>
        </div>

        <div class="form-row">
            <label>Data od
                <input type="date" th:field="*{dateFrom}" />
            </label>
            <label>Data do
                <input type="date" th:field="*{dateTo}" />
            </label>
            <div class="field-hint" th:if="${#fields.hasErrors('dateRangeValid')}" th:errors="*{dateRangeValid}">Błąd</div>
        </div>

        <div class="form-row">
            <label>Status <span class="req">*</span>
                <select th:field="*{status}" required>
                    <option th:each="s: ${T(com.milypol.security.task.TaskStatus).values()}"
                            th:value="${s}"
                            th:text="${s}">OPEN</option>
                </select>
            </label>
            <div class="field-hint" th:if="${#fields.hasErrors('status')}" th:errors="*{status}">Błąd</div>
        </div>

        <div class="form-row">
            <label>Użytkownicy (CTRL/CMD aby zaznaczyć wiele)
                <select th:field="*{users}" multiple size="6">
                    <option th:each="u : ${allUsers}" th:value="${u.id}" th:text="${u.firstname}">User</option>
                </select>
            </label>
        </div>

        <div class="form-row">
            <label>Auta (CTRL/CMD aby zaznaczyć wiele)
                <select th:field="*{cars}" multiple size="6">
                    <option th:each="c : ${allCars}" th:value="${c.id}" th:text="${c.name}">Car</option>
                </select>
            </label>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Zapisz</button>
            <a th:href="@{/tasks}" class="btn btn-secondary">Anuluj</a>
        </div>
    </form>
</section>

<script th:src="@{/js/tasks.js}"></script>
</body>
</html>