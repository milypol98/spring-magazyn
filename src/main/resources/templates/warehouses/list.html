<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <meta charset="UTF-8"/>
    <title>Magazyn</title>
    <link rel="stylesheet" th:href="@{/css/warehouses.css}"/>
</head>
<body>

<header class="page-header">
    <nav class="breadcrumbs" aria-label="breadcrumb">
        <a th:href="@{/}" class="crumb">Strona główna</a>
        <span class="sep">/</span>
        <span class="crumb current">Magazyn</span>
    </nav>
    <div class="header-row">
        <h1 class="page-title">Magazyn</h1>
        <div class="header-tools">


        </div>
    </div>
</header>

<main class="content">
    <div class="grid-2">
        <!-- Produkty -->
        <section class="card">
            <div class="table-header">
                <label class="table-title">Produkty</label>
                <a th:href="@{/warehouses/products/add}" class="btn btn-primary">+ Dodaj </a>
                <input type="text" class="table-search" placeholder="Szukaj produktu…" data-target="#productsTable">
            </div>

            <div class="table-wrapper">
                <table id="productsTable" class="table">
                    <thead>
                    <tr>
                        <th data-sort="text">Pozycja</th>
                        <th data-sort="text">Opis</th>
                        <th data-sort="number">Stan magazynu</th>
                        <th data-sort="number">Stan całkowity</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="p : ${products}"
                        class="clickable-row"
                        th:attr="data-href=@{/warehouses/products/{id}(id=${p.id})}">
                        <td th:text="${p.position}">P-001</td>
                        <td th:text="${p.name}">Nazwa</td>
                        <td th:text="${(countProductWarehouse[p.id] ?: 0)}"
                            th:classappend="${(countProductWarehouse[p.id] ?: 0) < p.minStock} ? ' low-stock'">0</td>
                        <td th:text="${(countProductWarehouseAndCar[p.id] ?: 0)}"
                            th:classappend="${(countProductWarehouseAndCar[p.id] ?: 0) < p.minStock} ? ' low-stock'">0</td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(products)}">
                        <td colspan="4">Brak produktów.</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Narzędzia -->
        <section class="card">
            <div class="table-header">
                <label class="table-title">Narzędzia</label>
                <a th:href="@{/warehouses/stocks/tools}" class="btn btn-primary">+ Dodaj </a>
                <input type="text" class="table-search" placeholder="Szukaj narzędzia…" data-target="#toolsTable">
            </div>

            <div class="table-wrapper">
                <table id="toolsTable" class="table">
                    <thead>
                    <tr>
                        <th data-sort="text">Pozycja</th>
                        <th data-sort="text">Opis</th>
                        <th data-sort="number">Stan magazynu</th>
                        <th data-sort="number">Stan całkowity</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="s : ${stockPositions}"
                        class="clickable-row"
                        th:attr="data-href=@{/warehouses/stocks/tools/{id}(id=${s.id})}">
                        <td th:text="${s.name}">Narzędzie</td>
                        <td th:text="${s.description}">Opis</td>
                        <td th:text="${(countToolsStatus[s.id] ?: 0)}"
                            th:classappend="${(countToolsStatus[s.id] ?: 0) < s.minStock} ? ' low-stock'">0</td>
                        <td th:text="${(countToolsPosition[s.id] ?: 0)}"
                            th:classappend="${(countToolsPosition[s.id] ?: 0) < s.minStock} ? ' low-stock'">0</td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(stockPositions)}">
                        <td colspan="4">Brak narzędzi.</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>
</main>

<script th:src="@{/js/warehouses.js}"></script>
</body>
</html>
