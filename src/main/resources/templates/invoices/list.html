<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <meta charset="UTF-8" />
    <title>Faktury - lista</title>
    <link rel="stylesheet" th:href="@{/css/general.css}" />
</head>
<body>
<header class="page-header">
    <nav class="breadcrumbs" aria-label="breadcrumb">
        <a th:href="@{/dashboard}" class="crumb">Strona główna</a>
        <span class="sep">/</span>
        <span class="crumb current">Faktury</span>
    </nav>
    <div class="header-row">
        <h1 class="page-title">Lista faktur</h1>
        <div class="header-tools">
            <a th:href="@{/invoices/add}" class="btn btn-primary">+ Dodaj fakturę</a>
        </div>
    </div>
</header>
<section th:if="${message}" class="flash">
    <span th:text="${message}">Operacja zakończona pomyślnie</span>
</section>

<!--<section class="filters">-->
<!--    <form th:action="@{/invoices}" method="get" class="filters-form">-->
<!--        <div class="row">-->
<!--            <label>-->
<!--                Szukaj-->
<!--                <input type="text" name="q" th:value="${q}" placeholder="numer, nazwa..." />-->
<!--            </label>-->
<!--            <label>Firma-->
<!--                <select name="companyId">-->
<!--                    <option th:each="c : ${companies}"-->
<!--                            th:value="${c.id}"-->
<!--                            th:text="${c.name}"-->
<!--                            th:selected="${companyId != null and companyId == c.id}">-->
<!--                    </option>-->
<!--                </select>-->
<!--            </label>-->
<!--            <label>-->
<!--                Data od-->
<!--                <input type="date" name="dateFrom" th:value="${dateFrom}" />-->
<!--            </label>-->
<!--            <label>-->
<!--                Data do-->
<!--                <input type="date" name="dateTo" th:value="${dateTo}" />-->
<!--            </label>-->
<!--            <label>-->
<!--                Rozmiar strony-->
<!--                <select name="size" th:value="${size}">-->
<!--                    <option th:value="10">10</option>-->
<!--                    <option th:value="20">20</option>-->
<!--                    <option th:value="50">50</option>-->
<!--                </select>-->
<!--            </label>-->
<!--            &lt;!&ndash; W formularzu filtrów dodaj select firmy &ndash;&gt;-->

<!--            <button type="submit" class="btn btn-primary">Filtruj</button>-->
<!--            <a th:href="@{/invoices}" class="btn btn-secondary">Wyczyść</a>-->
<!--        </div>-->
<!--    </form>-->
<!--</section>-->

<main class="content">
    <section class="card">
        <div class="table-header">
            <label class="table-title">Lista faktur</label>
            <input type="search"
                   class="table-search"
                   placeholder="Szukaj..."
                   data-target-table="#invoicesTable"
                   data-sum-columns="5:invSumNet,7:invSumVAT,8:invSumGross">
        </div>
        <div class="table-wrapper">
            <table id="invoicesTable" class="table">
                <thead>
                <tr>
                    <th>L.P.</th>
                    <th>Nr faktury</th>
                    <th>Nazwa</th>
                    <th>Firma</th>
                    <th>Waluta</th>
                    <th>Netto</th>
                    <th>Stawka VAT (%)</th>
                    <th>VAT</th>
                    <th>Brutto</th>
                    <th>Akcje</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="inv, i : ${invoices}">
                    <td th:text="${i.count}">1</td>
                    <td th:text="${inv?.invoiceNumber ?: '—'}"></td>
                    <td th:text="${inv?.name ?: '—'}">Acme</td>
                    <td>
                        <span th:if="${inv.company == null}" class="muted">—</span>
                        <a th:if="${inv.company != null}"
                           th:href="@{|/companies/${inv.company.id}|}"
                           th:text="${inv.company.name}">Firma</a>
                    </td>
                    <td th:text="${inv?.currency ?: '—'}"></td>
                    <td th:text="${inv?.totalNet ?: '—'}"></td>
                    <td th:text="${inv?.vatRate + '%' ?: '—'}"></td>
                    <td th:text="${inv?.calculatedVat ?: '—'}"></td>
                    <td th:text="${inv?.totalGross ?: '—'}"></td>
                    <td class="actions">
                        <a class="btn btn-small" th:if="${inv.storedFileName != null}"
                           th:href="@{/invoices/download/{id}(id=${inv.id})}"
                           target="_blank"
                           rel="noopener noreferrer">
                            Pobierz plik
                        </a>
                        <a class="btn btn-small" th:href="@{|/invoices/${inv?.id}|}">Szczegóły</a>
                        <a class="btn btn-small" th:href="@{|/invoices/edit/${inv?.id}|}">Edytuj</a>
                        <form th:action="@{|/invoices/${inv?.id}/delete|}" method="post" class="inline-form"
                              onsubmit="return confirm('Usunąć tę fakturę?');">
                            <button type="submit" class="btn btn-danger btn-small">Usuń</button>
                        </form>
                    </td>
                </tr>
                <tfoot th:if="${!#lists.isEmpty(invoices)}">
                <tr>
                    <td colspan="5" class="text-right"><strong>Suma</strong></td>
                    <td colspan="2" id="invSumNet"></td>
                    <td id="invSumVAT"></td>
                    <td id="invSumGross"></td>
                </tr>
                </tfoot>
                <tr th:if="${#lists.isEmpty(invoices)}">
                    <td colspan="15">Brak firm do wyświetlenia.</td>
                </tr>
                </tbody>
            </table>

<!--            <div th:if="${invoices != null and invoices.totalPages > 1}" class="pagination">-->
<!--                <a class="page-btn"-->
<!--                   th:classappend="${invoices.first} ? 'disabled'"-->
<!--                   th:href="@{/invoices(page=${invoices.number - 1}, size=${size}, q=${q}, dateFrom=${dateFrom}, dateTo=${dateTo})}">&laquo; Poprzednia</a>-->

<!--                <span class="page-info">-->
<!--            Strona <span th:text="${invoices.number + 1}">1</span>-->
<!--            z <span th:text="${invoices.totalPages}">1</span>-->
<!--            (łącznie: <span th:text="${invoices.totalElements}">0</span>)-->
<!--        </span>-->

<!--                <a class="page-btn"-->
<!--                   th:classappend="${invoices.last} ? 'disabled'"-->
<!--                   th:href="@{/invoices(page=${invoices.number + 1}, size=${size}, q=${q}, dateFrom=${dateFrom}, dateTo=${dateTo})}">Następna &raquo;</a>-->
<!--            </div>-->
        </div>
    </section>
</main>

<script th:src="@{/js/general.js}"></script>

</body>
</html>