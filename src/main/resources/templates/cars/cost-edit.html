<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <meta charset="UTF-8" />
    <title th:text="${car_cost.id} != null ? 'Edytuj koszt' : 'Dodaj koszt'">Koszt pojazdu</title>
    <link rel="stylesheet" th:href="@{/css/general.css}" />
</head>
<body>

<header class="page-header">
    <nav class="breadcrumbs" aria-label="breadcrumb">
        <a th:href="@{/dashboard}" class="crumb">Strona główna</a>
        <span class="sep">/</span>
        <a th:href="@{/cars}" class="crumb">Pojazdy</a>
        <span class="sep">/</span>
        <a th:href="@{/cars/info/{id}(id=${car_cost.car.id})}" class="crumb">Szczegóły pojazdu</a>
        <span class="sep">/</span>
        <span class="crumb current" th:text="${car_cost.id} != null ? 'Edytuj koszt' : 'Dodaj koszt'">Koszt</span>
    </nav>
    <div class="header-row">
        <h1 class="page-title" th:text="${car_cost.id} != null ? 'Edytuj koszt' : 'Dodaj koszt'">Koszt pojazdu</h1>

    </div>
</header>

<section class="form-container">
    <div class="table-header" style="margin-bottom: 1.5rem;">
        <label class="table-title">Formularz kosztu</label>
    </div>

    <form th:action="@{/cars/cost/save}" th:object="${car_cost}" method="post" novalidate>
        <input type="hidden" th:field="*{id}" />
        <input type="hidden" th:field="*{car.id}" />

        <div th:if="${#fields.hasErrors()}" class="flash" style="border-color:#fca5a5;background:#fef2f2;color:#991b1b;">
            Popraw błędy w formularzu.
        </div>

        <div class="form-grid">
            <div class="section-box span-2">
                <div class="section-header">Dane kosztu</div>
                <div class="subgrid" style="--cols: 2">
                    <div class="field">
                        <label for="description">Opis <span class="req">*</span></label>
                        <input id="description" type="text" th:field="*{description}" maxlength="255" th:classappend="${#fields.hasErrors('description')} ? 'invalid'" placeholder="np. Ubezpieczenie OC/AC" required />
                        <div class="error" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="cost">Kwota (PLN) <span class="req">*</span></label>
                        <div class="input-with-prefix">
                            <span class="prefix">PLN</span>
                            <input id="cost" type="number" th:field="*{cost}" step="0.01" min="0" th:classappend="${#fields.hasErrors('cost')} ? 'invalid'" placeholder="0.00" required />
                        </div>
                        <div class="error" th:if="${#fields.hasErrors('cost')}" th:errors="*{cost}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="dateFrom">Data od</label>
                        <input id="dateFrom" type="date" th:field="*{dateFrom}" th:classappend="${#fields.hasErrors('dateFrom')} ? 'invalid'" />
                        <div class="error" th:if="${#fields.hasErrors('dateFrom')}" th:errors="*{dateFrom}">Błąd</div>
                    </div>

                    <div class="field">
                        <label for="dateTo">Data do</label>
                        <input id="dateTo" type="date" th:field="*{dateTo}" th:classappend="${#fields.hasErrors('dateTo')} ? 'invalid'" />
                        <div class="error" th:if="${#fields.hasErrors('dateTo')}" th:errors="*{dateTo}">Błąd</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Zapisz</button>
            <a th:href="@{/cars/info/{id}(id=${car_cost.car.id})}" class="btn btn-secondary">Anuluj</a>
        </div>
    </form>
</section>

<!-- Lekki JS dla formularza kosztu -->
<script th:src="@{/js/general.js}"></script>
</body>
</html>